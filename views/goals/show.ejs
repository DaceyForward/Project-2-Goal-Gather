<%- include('../partials/nav') %>

<h5><%= goal.desc %></h5>

<% if (user) {%>
    <div>
        <a class="btn btn-light" href="/goals/edit/<%= goal._id %>" role="button">Edit This Goal</a>
    </div>
 <% } %>
<br>
<hr>
<br>
<h4>Objective List:</h4>

<div class="container-md">
    <% if (goal.objectives.length) { %>
        <div class="container-sm m-4">
            <% goal.objectives.forEach(obj => {%>
                <div class="card mb-4 shadow">
                    <div class="card-body">
                        <p><%= obj.desc %></p>
                        <div class="d-flex justify-content-between">

                            <% if (user && obj.author?._id == user.id) { %>
                                <form action="/objectives/<%= goal._id %>/<%= obj._id %>?_method=DELETE" method="POST">
                                    <input type="submit" class="btn btn-danger btn-sm" value="X">
                                </form>
                            <% } %>
                        </div>
                    </div>
                </div>
            <% }) %>
        </div>
    <% } else { %>
        <p>No Objectives Yet</p>
    <% } %>
</div>

<hr>
<br>



 <% if (user) { %>
    <div class="col-md-6">
        <form action="/objectives/goals/<%= goal._id %>" method="POST">
            <fieldset>
                <legend>Add A New Objective To This Goal</legend>
                <label class="form-label">Objective Description:</label>
                <input class="form-control mb-1" type="text" name="desc">
                <input type="submit" class="btn btn-light" value="Add Objective To This Goal">
            </fieldset>
        </form>
    </div>
<% } %>

<%- include('../partials/footer') %>